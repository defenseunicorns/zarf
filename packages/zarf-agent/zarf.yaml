kind: ZarfPackageConfig
metadata:
  name: "init-package-zarf-agent"
  description: "Install the zarf agent mutating webhook on a new cluster"

constants:
  - name: AGENT_IMAGE
    value: "###ZARF_PKG_VAR_AGENT_IMAGE###"

components:
  - name: zarf-agent
    description: |
      Mutating webhook that enables Kubernetes (or cloud) resources to run in airgap.
      Directs requests for external resources to internal Zarf-managed resources.
    required: true
    images:
      - "ghcr.io/defenseunicorns/zarf/###ZARF_PKG_VAR_AGENT_IMAGE###"
    manifests:
      - name: zarf-agent
        namespace: zarf
        files:
          - manifests/service.yaml
          - manifests/secret.yaml
          - manifests/deployment.yaml
          - manifests/webhook.yaml
