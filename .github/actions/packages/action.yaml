name: packages
description: "Create agent image, init package and example packages"

inputs:
  username:
    description: "Docker Hub username"
    required: true
  password:
    description: "Docker Hub password"
    required: true

runs:
  using: composite
  steps:
    - run: make build-cli-linux-amd
      shell: bash

    - uses: ../actions/agent-image
      with:
        username: ${{ inputs.username }}
        password: ${{ inputs.password }}

    - run: make init-package build-examples ARCH=amd64 AGENT_IMAGE=zarfdev/agent:$GITHUB_SHA
      shell: bash
