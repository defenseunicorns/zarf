kind: ZarfPackageConfig
metadata:
  name: scrape-zarf-agent
  description: Scrape Zarf Agent with Prometheus Operator.

components:
  - name: prometheus-deps
    required: true
    manifests:
      - name: prometheus-deps
        namespace: monitoring
        files:
          - manifests/prometheus-deps/bundle.yaml
    images:
      - quay.io/prometheus-operator/prometheus-operator:v0.66.0
    actions:
      onDeploy:
        after:
          - wait:
              cluster:
                kind: deployment
                name: prometheus-operator
                namespace: monitoring
                condition: available
  - name: prometheus-operator
    required: true
    manifests:
      - name: prometheus-operator
        namespace: monitoring
        files:
        - manifests/prometheus-operator/prometheus.yaml
        - manifests/prometheus-operator/servicemonitor-agent.yaml
        - manifests/prometheus-operator/clusterrole.yaml
        - manifests/prometheus-operator/clusterrolebinding.yaml
    images:
      - quay.io/prometheus/prometheus:v2.45.0
      - quay.io/prometheus-operator/prometheus-config-reloader:v0.66.0
