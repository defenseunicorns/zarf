apiVersion: v1
kind: Namespace
metadata:
  name: pepr-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
rules:
  - apiGroups:
      - '*'
    resources:
      - '*'
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
subjects:
  - kind: ServiceAccount
    name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
    namespace: pepr-system
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
  namespace: pepr-system
---
apiVersion: v1
kind: Secret
metadata:
  name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b-api-token
  namespace: pepr-system
type: Opaque
data:
  value: >-
    NDgyNDRmMjE5OGQwNTBjODZkZGFjNzA1MjBhMTI1YzUwNDY4MWZiYTY4YTRkZDhjZTJmNTQ3YmI2OWY0ZDEzYw==
---
apiVersion: v1
kind: Secret
metadata:
  name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b-tls
  namespace: pepr-system
type: kubernetes.io/tls
data:
  tls.crt: >-
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tDQpNSUlDd3pDQ0FhdWdBd0lCQWdJQkFUQU5CZ2txaGtpRzl3MEJBUXNGQURBQU1CNFhEVEl6TURreE5USXhOVEkxDQpNRm9YRFRJME1Ea3hOVEl4TlRJMU1Gb3dBRENDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DDQpnZ0VCQUluSUZTSjNuUVN6U2lzMk1Wbyt6alNHQ042WUNsTkoxSkhUcWRVN3g3RHNydHFsdGYrYXJ2NlBiUEk1DQpYTFkxeG5iZm5jN21oMThjTk4xTGlYSmNNMmhreG1IZWlQVkxTK1liaCtydERLRFVzWXpwdWxWUmd2QTNwZE1LDQpwYks2b1BxcVJrMDJWV1E2TEZQTlc0QUFGQ1d4b0NIa2JGbzNOL3BZOGkwVE5aQTVURDNKZjF0RmRCdk9mN2tRDQpIa0FZc2lzR2lYb1ZiWENINUdiQzloa2htR2t0T0pQQmxRNXpJTjVwaEU0cWhJbmFLQ0Z5MzJqdUIvUVp0TzBlDQpNb0JFb3N3elRUS0VKcGt1aHRqZ1VkUmVtMHQyUysxaVN5RENSSy9pMUJNaTE0WjY2YzJUSkVYaTBkdmh3dDhUDQp2c1RzcTZwaFRRRWFXNkIzd0wrNEY5ZlA0cnNDQXdFQUFhTklNRVl3UkFZRFZSMFJCRDB3TzRJNWNHVndjaTFqDQpZalUyT1RObFppMWtNVE5qTFRWbVpURXRZalZoWkMxak9EY3dabVE1TVRGaU0ySXVjR1Z3Y2kxemVYTjBaVzB1DQpjM1pqTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFDZmRpQ3hGQzVmUGpobW5WOExZR2paaHVNejRrODlTM2UzDQpUb2tpYUhROCtadDBPK2RwMEZRQVlDTjQ5enpyQ2dpSThDUDBHZlViM21uWFcwYzgxTzZQQTRha20zK3BIbVJHDQpVamZDK29UKzVNazJ5cVB0UC9YLzk3NkRBbFU1cEREWjhieWlhbzhOaC9PZGRSdWVZd3F5RUJNYXJQcTZwSytlDQpiejFtTG5DQ2VsL3AzS3FJRlFVMWdZZmdONFpERWV0WUNvdkpmMldQOWNtNXU0WWNGV3J2d0JqTlk2OWIvSFVzDQo3VGdteXZlTVpwbkRBYzEzeHFrUkZDVTdXSThQNUI4V1J4Q1J0dDVGZjNRdUpyMStadENKSEFUR1FsWldZeFlzDQpXYzg0cU5hQ2RlTE93Ulk5a3JDUnNJSkJMaS9jeU1DVEh0ZWp3Uy9VZk9RSVVpTmNtVlVuDQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tDQo=
  tls.key: >-
    LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQ0KTUlJRW9nSUJBQUtDQVFFQWljZ1ZJbmVkQkxOS0t6WXhXajdPTklZSTNwZ0tVMG5Va2RPcDFUdkhzT3l1MnFXMQ0KLzVxdS9vOXM4amxjdGpYR2R0K2R6dWFIWHh3MDNVdUpjbHd6YUdUR1lkNkk5VXRMNWh1SDZ1ME1vTlN4ak9tNg0KVlZHQzhEZWwwd3Fsc3JxZytxcEdUVFpWWkRvc1U4MWJnQUFVSmJHZ0llUnNXamMzK2xqeUxSTTFrRGxNUGNsLw0KVzBWMEc4NS91UkFlUUJpeUt3YUplaFZ0Y0lma1pzTDJHU0dZYVMwNGs4R1ZEbk1nM21tRVRpcUVpZG9vSVhMZg0KYU80SDlCbTA3UjR5Z0VTaXpETk5Nb1FtbVM2RzJPQlIxRjZiUzNaTDdXSkxJTUpFcitMVUV5TFhobnJwelpNaw0KUmVMUjIrSEMzeE8reE95cnFtRk5BUnBib0hmQXY3Z1gxOC9pdXdJREFRQUJBb0lCQUM1ZE40dDFMOC9rbTBsRw0KUDc1TUV5ekdpOWFIMkRXbHl4UFZZN21mRjdnWU5WRGJZWTZsV1V6Tks4Nm84ZU5ZM2pPalZTSEtIblNwYzdxaQ0KRUJyOUhzbDYyKzBVS3dkTU1ycTR1ZmlhazF6TnBmK3lxU0xMdnFHaVFEbHZ4RW1NRnQ2ekROd3ZzL1Y1dysvaA0KVTNDVDFqUEcvWWxhS2dJRHdlRUxMRmR4dHQwVWhJTXdUaXh2WjRLT1VkQWhvWHBLVTNtYkQ4dHpqR29sRzVkQw0KMVhJeEp3T0N5WVN2WkFjZS83cG9mSlovakJBczd0UkFVNklqUnFDV3V1aURXSzIvSDlHTkxOeGEvenhlL1ZKSQ0KVitoZnlNVmsxN0NZYWZNb0dWalpNalBjdmdyd2RDM1BwczF3WlJiNkpzVk95aU9FZDJUTi9heGxxSXhkRFIrTQ0Kd3BtT0tUVUNnWUVBdnFLNm5rekUydzVzaVgyWWtaNmhXVi9GendwWjVHVU9VcjBpMlI2VVBpbnRLVnY2YWNlUA0KOFNXWk54emJBajFuNkRHMHpKeWNwMmRjVzdlNHZkZXdWc3doaEY5TEJ5UDV3S1RURHZxMUczeFMrZ0V3ZlhkYQ0KUmJtSys1WUNIZkYzUDQyTjNtMnlJUGczQmdOOEpwaVV0c1RKNnJJQmFJU2sxSVNObXJocjNxVUNnWUVBdVFZRg0KL1NnN0djQ0xhbi84RW9VV0twQzY0YjlMNmI2QVJwZ2srN29YVHBpdWZqdUx3QlpXQzN0L1BIV3MxUFVpd0Zycg0KSjZ1Q0w2L1lJOXhPaFlla3U3V0lvU3ZkVUNaU0NUNHlCWnByTTlmckQyb2Z5dlpIMFhLSVF6bVRMcWRnNElKYw0KOFNPTndNaEgwbW9ndEZ3cGZZUUF5cnl2bmpsVXBOS1BoTGRyWGQ4Q2dZQVlSVyt0SitrSVd0WEd5NDdaTzNFZg0KaCtvUGFpbjN3a1lJa3J3VkdLZVhJbzluYktaOVFVTTZXS2NoTlROTkhiUlZBNzhaTGZkaitPenhZSHJNOE9FcQ0KcStLNGo4bGxwMWJ0Q0E4M0lRUmQ4MzQ5QmxtK0g2d0dwSkRsWnp2dHhBaUN0dXNSSHJaSExGTVZHT3g5blgrUg0KcFl4dnJTb3d2SEtmL0NCclNuK3hZUUtCZ0Y5Z09vQVlWL2JiYVVLWi9OK3pHUTBTRkRQQWY2cGJXQmFMNFN5ZA0KN2R2SEd0UFpjQjJ4cGVNL1l3UlFpS295UHhxM0ExY3NzdXhRRWZQU1lldTFVM2FyaW1YQ2pjLytJUFhBeU5wWQ0Ka29Ca0FqaXM5UHlUM2N1YTVhRDVzZVF2eGVHVmNjR2dHVGRTUnF1eHAzQXh2ZldFc1QvUTZocCs1U0lkcEh1Kw0KYlNzekFvR0FEUUNXTlhnckY4YVd6OTRLVXpmbHVBMmdvd2xURVBnTmJxNHBIenBXNjIrVFExYzZxSGwyWm5zZw0KTVJkejlhR2FJOUZiZmlMd21EdGx5aFhIc1R6Ync3Qi91SUVlVDZkajhOSUpQd0wrRHZkcE1PS25iSk5OV0pYVg0KTU1LUHMvT25lT29mdXhJYWhyeG04bm1iUkVhbC90MGMwcWtaZzhPRU56U3gxS2ZtbHVZPQ0KLS0tLS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0NCg==
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
  namespace: pepr-system
  labels:
    app: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
spec:
  replicas: 2
  selector:
    matchLabels:
      app: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
  template:
    metadata:
      labels:
        app: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
    spec:
      priorityClassName: system-node-critical
      serviceAccountName: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
      containers:
        - name: server
          image: ghcr.io/defenseunicorns/pepr/controller:v0.13.3
          imagePullPolicy: IfNotPresent
          command:
            - node
            - /app/node_modules/pepr/dist/controller.js
            - 35118f6395c055e9b92f56df57df2630c1a7f8c4712f8ce011ff1dfde6c20842
          readinessProbe:
            httpGet:
              path: /healthz
              port: 3000
              scheme: HTTPS
          livenessProbe:
            httpGet:
              path: /healthz
              port: 3000
              scheme: HTTPS
          ports:
            - containerPort: 3000
          env:
            - name: PEPR_PRETTY_LOG
              value: 'false'
          resources:
            requests:
              memory: 64Mi
              cpu: 100m
            limits:
              memory: 256Mi
              cpu: 500m
          volumeMounts:
            - name: tls-certs
              mountPath: /etc/certs
              readOnly: true
            - name: api-token
              mountPath: /app/api-token
              readOnly: true
            - name: module
              mountPath: /app/load
              readOnly: true
      volumes:
        - name: tls-certs
          secret:
            secretName: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b-tls
        - name: api-token
          secret:
            secretName: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b-api-token
        - name: module
          secret:
            secretName: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b-module
---
apiVersion: v1
kind: Service
metadata:
  name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
  namespace: pepr-system
spec:
  selector:
    app: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
  ports:
    - port: 443
      targetPort: 3000
---
apiVersion: v1
kind: Secret
metadata:
  name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b-module
  namespace: pepr-system
type: Opaque
data:
  module-35118f6395c055e9b92f56df57df2630c1a7f8c4712f8ce011ff1dfde6c20842.js.gz: >-
    H4sIAAAAAAAAE41WbZPbNBD+zq9QBXO1qawmkym0zviOTgpMoW/Ta+kMN2FOttaOGkcyknwhpP7vrOwkpG0O+iGOLO1qd59nX3wjLKmzl/l7KDyXUCoNr6xpwPrN9AbPZBZpZuLsvMZ/qsUKKNveiLqF1LDC6FJVrRV5DemdURf3KovMwp+tshDRBhpLh9082wbtlMJfYtXUkKwhXxizpOwGrFNGp3TER3xMmQRXWNX4fo+yJWzWxkqXXg3XMbp86PDZmFoVmwR0hT6HdzxMVka2dXhzULRW+Q2ds0HCpVttJNo/z8YP0dCIdiyopLe51bZKprTIH3z3aAJlIseTInlQwjjJHwiZFA+/H5Xy0XicT3LKjP7RWmNTqiptLNoX9Vps3NP+bbDgGlGgE1dzVosc6rDqOjZEir7R5UQmDnzb0DSsSVG3zgMSADV4IH10Em7I2Rk5Pi4siOPjJFlOXCJsRe4muJG31Q8OLEKcju5ixBIa0BJ0oQIgffz0D0R9wie063qixEn6mkzDmgg+E43IVY3IRrcB9xF/j4lT4ZjsxEhxuIB4Q9zCrEn47bQdQa6XZK38gvwubEkQtaWoAGFoarNZgfaOU3YMKP0b5ei8i9n23QJ0WnZZMy0jwQW/BITHx/ypm/UwyZf2bSPDIsJN/WJ/SzTcEfN3aPdZoAdjHwwng+FE6dKgwPPWo3qks/Mt0kJMpvlrsWbALHPZnfHU283WZsKbPDIcLYn+EYfDUVcIXyzw+OikCwqQ/XL58gVvhHUQ2XiQi3y8FfyZqTiE1IpoKVQNMoDWCxK/AOL6AP+9LiX0no+nuNda3ZWoFrxEP0sCF3wIBeTMrBqjA5QXF1fz2HOHQbUuyzL6pBdRuqJnZ9Fgvk+i6PoNmiv2iuSbreeBhI4ot+MGla5jBvwg9G5H6QW/8he99ByX1IPzh2TBHZP3CSp/Bg1WhKxBR4BXh9eLL/JjIRwRNdIsN7iWROxTCjMPewFyThAPojwnL4zfbaLPRGiDUFp+HafRCe8/fDi1m227k7FeDe7Ms+3Hce67zEebbMA9pa9brQPm7HMs0mMksGEsMa9W4EVPebiTDRbjOJ4GBu+MLo7SK8u9EVGfXc5bNKHKTYSy6bHMZ8fYx4Xb6IKUrS6CXbLsh8BWrIXypIrGo3gaEgt2TQEbMv+1zWHWz4Mp8NoI+ZM1qydQirb20SBukdaVWMLjRs1qhahFg+oMm+RvY9yN+/rpUzaLBmOWB0oPlSqHkg6zaCjZmOdGbthqqDl/XHPquKxWMSsydYIwcyIpp8UtaamOyMACKfaVQy/bogCQICk7beRTE1kRM/8/RKk4ZnsUmtATboWBeXZjlCSj//zbLhBKHLY4bZApjw4mbzYN4MARTYPDtA/rPtrHFlepIlmBxQbYW7733hmNE2LfnFy8HZoMOe5R1291+BQIPart+2zfpPYtfGhWKdbsJ3G6uMPO4bpORkuc3DVA81jL2ULoCi57gHEIHXKxivTBeEg//FxZKWTYZOc4P9+oFZjWR4bpb8cwiWO8tNpdircEhQV/hXPtef+lEOXsqpnH06/u3/+aONPaAp4jGOjY29fPsn6qfskXAH/vMLObr/4BbLzkE04JAAA=
---
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
webhooks:
  - name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b.pepr.dev
    admissionReviewVersions:
      - v1
      - v1beta1
    clientConfig:
      caBundle: >-
        LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tDQpNSUlDdERDQ0FaeWdBd0lCQWdJQkFUQU5CZ2txaGtpRzl3MEJBUXNGQURBY01Sb3dHQVlEVlFRREV4RlFaWEJ5DQpJRVZ3YUdWdFpYSmhiQ0JEUVRBZUZ3MHlNekE1TVRVeU1UVXlOVEJhRncweU5EQTVNVFV5TVRVeU5UQmFNQUF3DQpnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFDOHhwV1VXYTVGZ3JLaTdkNTBIMG9VDQpzRWI5aG0rUU5IUTl3WFRjczIrRUQ5Y1ZWbXhzVWxYdll3RlpXenBrWDdEbXFORGlOT2dOZVFHRE1JbG1Hay9xDQpZRTdIYXk4bGZsTm5IL0JXSWhQays1cU5kRGY3MmpYU0xOY3RWRlFpdlZqb1RtdE1Hb3lRTnc5Sk1aZ1Bld0VqDQovMGNnbjNhbUY1RFJEdG9zSFJvcjVQSmMwcFVTOGdFSkNxTTVoeWZzaWQrZGVBMzg1VHAramVkQ053d3BNcFJaDQo1NC85cVNTa0tOL1BiSmduQ0hTY21RZTh6QWUrNk5Jbk8reVlXeHErVUZOT3lYL3JyKzRZdzhYTTZzdDJHakRVDQpEQ2s1TDlEY1IwSktaUVE0MDVjcHBtb1Btb0pzVlcxUVNNcEYwcVRBWmtKYTMrUEFqd1c5WXpYWmduUzlDR29ODQpBZ01CQUFHakhUQWJNQXdHQTFVZEV3UUZNQU1CQWY4d0N3WURWUjBQQkFRREFnTDBNQTBHQ1NxR1NJYjNEUUVCDQpDd1VBQTRJQkFRQWdFTys2QUJCdEF6TFhsU2NBazZyZ1ErMlp6QlhjMExGTEhvMWQyYk5qM1lGQXhnSTNkbTB0DQpYdldkYjRDekY0N0VwQWJkUkJVYlV6QzZ5WldRaDBwOGdZTkVDVXQvQlphSFBoZ2ltU2hMOWRQNnl0bXdOWitmDQptRkxLeXJaVTRQRWlicUhPclpiSVVucm5tT291OGxKNHVUQ1BLVURTNmIraUl4SGtYdDRJWFB1NFd2bVIwTTlaDQorQTlXSVBqRFdPb1QwbkMzNjRQb2pwaVJCWWQrQnVTVDFId2JPWitDZ2JSTGIxVmxVb3N4elRoQ0ZIcnozRm9lDQpyTHlpUndSb1ZKN3p2NkNySm12dlYrdzRra0Zxd1IwVUV3RWdmL1RJQ1daZlN1U0RWd29XdXZqRzJlVnBNaXFSDQpHZy91NmphUXpURzJiUWM1YUFlbkMrVVRIdTM0dmpvMg0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQ0K
      service:
        name: pepr-cb5693ef-d13c-5fe1-b5ad-c870fd911b3b
        namespace: pepr-system
        path: >-
          /mutate/48244f2198d050c86ddac70520a125c504681fba68a4dd8ce2f547bb69f4d13c
    failurePolicy: Ignore
    matchPolicy: Equivalent
    timeoutSeconds: 10
    namespaceSelector:
      matchExpressions:
        - key: pepr.dev
          operator: NotIn
          values:
            - ignore
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
            - kube-system
            - pepr-system
    objectSelector:
      matchExpressions:
        - key: pepr.dev
          operator: NotIn
          values:
            - ignore
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
            - kube-system
            - pepr-system
    rules:
      - apiGroups:
          - ''
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - secrets
    sideEffects: None
